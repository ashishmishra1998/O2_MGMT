{% extends "base.html" %}
{% block title %}Admin Dashboard{% endblock %}

{% block content %}
<h2>Admin Dashboard</h2>
<div class="row text-center mb-4">
    <div class="col-md-2 col-6">
        <div class="card bg-light mb-3">
            <div class="card-body">
                <h5 class="card-title">Total Bottles</h5>
                <p class="card-text display-6">{{ total_bottles }}</p>
            </div>
        </div>
    </div>
    <div class="col-md-2 col-6">
        <div class="card bg-success text-white mb-3">
            <div class="card-body">
                <h5 class="card-title">Delivered</h5>
                <p class="card-text display-6">{{ delivered }}</p>
            </div>
        </div>
    </div>
    <div class="col-md-2 col-6">
        <div class="card bg-info text-white mb-3">
            <div class="card-body">
                <h5 class="card-title">Returned</h5>
                <p class="card-text display-6">{{ returned }}</p>
            </div>
        </div>
    </div>
    <div class="col-md-2 col-6">
        <div class="card bg-warning text-dark mb-3">
            <div class="card-body">
                <h5 class="card-title">In Stock</h5>
                <p class="card-text display-6">{{ in_stock }}</p>
            </div>
        </div>
    </div>
    <div class="col-md-2 col-6">
        <div class="card bg-danger text-white mb-3">
            <div class="card-body">
                <h5 class="card-title">Pending Return</h5>
                <p class="card-text display-6">{{ pending }}</p>
            </div>
        </div>
    </div>
</div>
<style>
    .inventory-card:hover {
        box-shadow: 0 4px 16px rgba(32, 191, 169, 0.18), 0 0 0 2px #fff;
        filter: brightness(1.05);
    }
</style>
<h4>Recent Transactions</h4>
<table class="table table-bordered table-striped">
    <thead>
        <tr>
            <th>Date</th>
            <th>Client</th>
            <th>Bottles</th>
            <th>Type</th>
            <th>Delivered By</th>
        </tr>
    </thead>
    <tbody>
        {% for t in recent_transactions %}
        <tr>
            <td>{{ t.date|date:'Y-m-d H:i' }}</td>
            <td>{{ t.client.name }}</td>
            <td>
                {% with t.bottles.count as bottle_count %}
                <button type="button" class="btn btn-sm btn-info" data-bs-toggle="modal" data-bs-target="#bottlesModal{{ t.id }}">
                    Show {{ bottle_count }} Bottle{% if bottle_count != 1 %}s{% endif %}
                </button>
                {% endwith %}
                <!-- Modal -->
                {% include 'partials/transaction_bottle_modal.html' with transaction=t %}

            </td>
            <td>{{ t.get_transaction_type_display }}</td>
            <td>{{ t.delivered_by.username }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="6" class="text-center">No recent transactions.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}